### Swift和Objective-C注意事项

#### 一、Swift使用或者继承Objective-C

> 在Objective-C项目中第一次建立Swift文件时，Xcode会提示你是否要生成桥接文件：`ProjectName-Bridging-Header.h` , 当然不小心没有选择生成或者删除之后，手动添加也可以：建立 `ProjectName-Bridging-Header.h` ,在 `Targets-->Build Settings-->Swift Compiler - General-->Objective-C Bridging Header`配置文件路径。然后在 `ProjectName-Bridging-Header.h` 中 `import "Objective-C-File.h"` , 在项目的Swift便可以使用或者继承 `Objective-C-File` 了 。

**注意点：**

1、在framework中，是没有办法使用这个桥接文件的，就算你生成了这个桥接文件，并且正确的配置了 Objective-C Bridging Header 路径，编译的时候会提示 “using bridging headers with framework targets is unsupported“ 错误。所以怎么在Swift中使用或者继承Objective-C文件呢？
解决方式：虽然不支持桥接文件，并且Swift也不可以直接继承或者使用Objective-C文件的，所以需要在framework的头文件（比如framework为HDTestLib.framework,头文件即为HDTestLib.h）对Objective-C文件声明，然后设置权限为 Public，并且设置Objective-C文件头文件权限为 Public

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc1.png) 

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc2.png) 

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc3.png) 



[排雷记录：Swift +Objective-C混合Framework的一些问题](http://blog.csdn.net/cooldragon/article/details/50172649) 



2、在cocoapods中，如果要 Swift 继承 Objective-C 文件，会和上面的framework存在类似的问题：没有桥接文件。

解决方式：在cocoapods中，没有所谓的头文件，但是有了一个 `ProjectName-umbrella.h` 文件（默认是 Public ）, 它的一个功能便是 头文件 作用，所以我们需要做的是将 Objective-C 文件 在  `ProjectName-umbrella.h` 文件 申明即可。( 什么是  `ProjectName-umbrella.h`：  [Pod Authors Guide to CocoaPods Frameworks](http://blog.cocoapods.org/Pod-Authors-Guide-to-CocoaPods-Frameworks/) ) 

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc4.png) 

编译会发现有另外一个问题：

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc5.png) 

这个报错的文件是 `HDTestPod-Swift.h` , 它是系统生成的Swift文件对应的Objective-C的头文件，具体可以在`Targets-->Build Settings-->Swift Compiler - General-->Objective-C Generated Interface Header Name`进行配置，默认文件名是`工程名-Swift.h`，一般不做改动。可以看到 Swift转成Objective-C代码后，因为继承 `ObjcSuperClassPod` , 并且 cocoapods 本质是framework，这就让Xcode在转换中，自动了导入了 `<HDTestPod/HDTestPod.h>` , 然而在cocoapods中并没有了这个头文件，所以报错。

解决方式：既然是说找不到这个文件，我们便在cocoapods重新加上这个头文件，和第1个问题一样，设置它的访问权限为 Public。

![](http://7xqhx8.com1.z0.glb.clouddn.com/swift_oc6.png) 



当 SwiftSubClassPod 继承 ObjcSuperClassPod 时，`HDTestPod-Swift:` 

```objective-c
// Generated by Apple Swift version 3.0.2 (swiftlang-800.0.63 clang-800.0.42.1)
#pragma clang diagnostic push
...
...
...
#import <HDTestPod/HDTestPod.h>

#pragma clang diagnostic ignored "-Wproperty-attribute-mismatch"
#pragma clang diagnostic ignored "-Wduplicate-method-arg"

SWIFT_CLASS("_TtC9HDTestPod16SwiftSubClassPod")
@interface SwiftSubClassPod : ObjcSuperClassPod
+ (void)dosome;
- (void)instanceDosome;
- (nonnull instancetype)init OBJC_DESIGNATED_INITIALIZER;
@end

#pragma clang diagnostic pop
```

当 SwiftSubClassPod 继承 NSObject 时，`HDTestPod-Swift:` 

```objective-c
// Generated by Apple Swift version 3.0.2 (swiftlang-800.0.63 clang-800.0.42.1)
#pragma clang diagnostic push
...
...
...
#if defined(__has_feature) && __has_feature(modules)
@import ObjectiveC;
#endif

#pragma clang diagnostic ignored "-Wproperty-attribute-mismatch"
#pragma clang diagnostic ignored "-Wduplicate-method-arg"

SWIFT_CLASS("_TtC9HDTestPod16SwiftSubClassPod")
@interface SwiftSubClassPod : NSObject
+ (void)dosome;
- (void)instanceDosome;
- (nonnull instancetype)init OBJC_DESIGNATED_INITIALIZER;
@end

#pragma clang diagnostic pop
```



上面两个问题对应的 [Demo地址](https://github.com/erduoniba/HDSwiftUseOC.git) 



#### 二、Objective-C使用Swift

> 相信在Swift日益普及的前提下，Objective-C使用Swift场景会越来越少，当在OC文件中调用Swift文件中的类的时候，首先在OC文件中要加上 #import "ProjectName-swift.h ，这个文件上面也说明了，是系统生成的Swift文件对应的Objective-C的头文件。

**注意点：**

1、如何找到这个系统生成的 `ProjectName-swift.h  ` ?

这个文件虽然在工程中看不到，但是它时真实存在的，编译后，按住 command 点击 `import "ProjectName-swift.h"` 便可以看到源代码，右键选择 `Jump bars` 上的 `ProjectName-swift.h` , 如下图：

![](http://7xqhx8.com1.z0.glb.clouddn.com/oc_swift.gif) 

[Xcode概览：在工作区窗口开发您的应用程序](http://www.cocoachina.com/ios/20141203/10392.html)



2、    Objective-C 文件不能继承自定义的 Swift 类。

[Swift and Objective-C in the Same Project](https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/MixandMatch.html#//apple_ref/doc/uid/TP40014216-CH10-ID122)



3、framework、cocoapods中的 Swift 文件，如果想被项目中使用或者继承，需要加上权限关键字：

**public:**  可以被任何人访问。但其他module中不可以被override和继承，而在module内可以被override和继承。

**open:**  可以被任何人使用，包括override和继承。













